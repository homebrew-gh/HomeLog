@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    /* Sky Blue Light Theme */
    --background: 200 50% 98%;
    --foreground: 215 25% 15%;

    --card: 0 0% 100%;
    --card-foreground: 215 25% 15%;

    --popover: 0 0% 100%;
    --popover-foreground: 215 25% 15%;

    --primary: 199 89% 48%;
    --primary-foreground: 0 0% 100%;

    --secondary: 200 40% 94%;
    --secondary-foreground: 215 25% 20%;

    --muted: 200 30% 94%;
    --muted-foreground: 215 16% 46%;

    --accent: 200 40% 92%;
    --accent-foreground: 215 25% 20%;

    --destructive: 0 84% 60%;
    --destructive-foreground: 0 0% 100%;

    --border: 200 30% 88%;
    --input: 200 30% 88%;
    --ring: 199 89% 48%;

    --radius: 0.75rem;

    --sidebar-background: 200 40% 97%;
    --sidebar-foreground: 215 20% 25%;
    --sidebar-primary: 199 89% 48%;
    --sidebar-primary-foreground: 0 0% 100%;
    --sidebar-accent: 200 35% 93%;
    --sidebar-accent-foreground: 215 25% 20%;
    --sidebar-border: 200 25% 88%;
    --sidebar-ring: 199 89% 48%;
  }

  .dark {
    /* Dark Theme with Sky Blue Accents */
    --background: 220 20% 10%;
    --foreground: 200 20% 95%;

    --card: 220 18% 13%;
    --card-foreground: 200 20% 95%;

    --popover: 220 18% 13%;
    --popover-foreground: 200 20% 95%;

    --primary: 199 89% 55%;
    --primary-foreground: 220 20% 10%;

    --secondary: 220 15% 20%;
    --secondary-foreground: 200 20% 95%;

    --muted: 220 15% 18%;
    --muted-foreground: 200 15% 60%;

    --accent: 220 15% 20%;
    --accent-foreground: 200 20% 95%;

    --destructive: 0 62% 45%;
    --destructive-foreground: 0 0% 100%;

    --border: 220 15% 20%;
    --input: 220 15% 20%;
    --ring: 199 89% 55%;

    --sidebar-background: 220 18% 11%;
    --sidebar-foreground: 200 15% 90%;
    --sidebar-primary: 199 89% 55%;
    --sidebar-primary-foreground: 220 20% 10%;
    --sidebar-accent: 220 15% 18%;
    --sidebar-accent-foreground: 200 15% 90%;
    --sidebar-border: 220 15% 18%;
    --sidebar-ring: 199 89% 55%;
  }
}

@layer base {
  * {
    @apply border-border;
  }

  html {
    /* Support for notched devices */
    padding: env(safe-area-inset-top) env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left);
  }

  body {
    @apply bg-background text-foreground;
    /* Prevent pull-to-refresh on mobile */
    overscroll-behavior-y: contain;
    /* Smooth scrolling */
    -webkit-overflow-scrolling: touch;
  }

  /* Disable text selection on interactive elements for native app feel */
  button, [role="button"] {
    -webkit-user-select: none;
    user-select: none;
    -webkit-tap-highlight-color: transparent;
  }
}

/* Tool pattern background for home/construction theme */
.tool-pattern-bg {
  position: relative;
  isolation: isolate;
}

.tool-pattern-bg::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  pointer-events: none;
  z-index: -1;
  opacity: 0.04;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='200' height='200' viewBox='0 0 200 200'%3E%3Cg fill='%230284c7' fill-opacity='1'%3E%3C!-- Hammer --%3E%3Cpath d='M25 35 L25 20 L35 20 L35 25 L30 25 L30 35 L25 35 M27 35 L27 55 L28 55 L28 35' /%3E%3C!-- Screwdriver --%3E%3Cpath d='M75 18 L80 18 L80 22 L78.5 24 L78.5 50 L76.5 50 L76.5 24 L75 22 L75 18 M76.5 50 L76.5 55 L78.5 55 L78.5 50' /%3E%3C!-- Wrench --%3E%3Cpath d='M125 20 C120 20 118 25 120 28 L120 30 L122 30 L122 50 L128 50 L128 30 L130 30 L130 28 C132 25 130 20 125 20 M123 22 C124 21 126 21 127 22 C128 23 128 25 127 26 L123 26 C122 25 122 23 123 22' /%3E%3C!-- Drill --%3E%3Cpath d='M170 25 L185 25 L185 35 L180 35 L180 32 L175 32 L175 35 L170 35 L170 25 M165 28 L170 28 L170 32 L165 32 L165 28 M185 28 L195 29 L195 31 L185 32' /%3E%3C!-- Saw --%3E%3Cpath d='M20 85 L55 85 L55 90 L53 92 L51 90 L49 92 L47 90 L45 92 L43 90 L41 92 L39 90 L37 92 L35 90 L33 92 L31 90 L29 92 L27 90 L25 92 L23 90 L20 90 L20 85 M20 82 L25 82 L25 85 L20 85' /%3E%3C!-- Pliers --%3E%3Cpath d='M80 80 L85 85 L83 87 L80 84 L80 95 L78 95 L78 84 L75 87 L73 85 L78 80 L80 80 M78 95 L76 100 L74 100 L76 95 M80 95 L82 100 L84 100 L82 95' /%3E%3C!-- Tape Measure --%3E%3Ccircle cx='130' cy='90' r='12' fill='none' stroke='%230284c7' stroke-width='3'/%3E%3Cpath d='M130 90 L145 90 L145 88 L130 88' /%3E%3Ccircle cx='130' cy='90' r='4' /%3E%3C!-- Level --%3E%3Cpath d='M165 85 L195 85 L195 95 L165 95 L165 85 M175 87 L185 87 L185 93 L175 93 L175 87' fill='none' stroke='%230284c7' stroke-width='2'/%3E%3Ccircle cx='180' cy='90' r='2' /%3E%3C!-- Paint Roller --%3E%3Cpath d='M25 130 L25 140 L50 140 L50 130 L25 130' fill='none' stroke='%230284c7' stroke-width='2'/%3E%3Cpath d='M37 140 L37 155 L38 155 L38 140' /%3E%3Crect x='35' y='155' width='6' height='3' /%3E%3C!-- Lightbulb --%3E%3Cpath d='M80 125 C73 125 68 130 68 137 C68 142 72 145 75 148 L75 155 L85 155 L85 148 C88 145 92 142 92 137 C92 130 87 125 80 125' fill='none' stroke='%230284c7' stroke-width='2'/%3E%3Cpath d='M76 155 L76 158 L84 158 L84 155 M77 158 L77 160 L83 160 L83 158' /%3E%3C!-- House --%3E%3Cpath d='M130 155 L130 135 L120 145 L120 155 L130 155 M125 125 L110 140 L112 142 L125 130 L138 142 L140 140 L125 125 M130 135 L140 145 L140 155 L130 155' fill='none' stroke='%230284c7' stroke-width='2'/%3E%3Crect x='123' y='147' width='4' height='8' /%3E%3C!-- Gear/Cog --%3E%3Ccircle cx='180' cy='140' r='8' fill='none' stroke='%230284c7' stroke-width='2'/%3E%3Ccircle cx='180' cy='140' r='3' /%3E%3Cpath d='M180 130 L180 133 M180 147 L180 150 M170 140 L173 140 M187 140 190 140 M173 133 L175 135 M185 145 L187 147 M173 147 L175 145 M185 135 L187 133' stroke='%230284c7' stroke-width='2'/%3E%3C!-- Nail --%3E%3Cpath d='M35 175 L35 195 L37 195 L37 178 L40 175 L35 175' /%3E%3C!-- Screw --%3E%3Cpath d='M80 170 L80 172 L75 172 L75 174 L85 174 L85 172 L80 172 M77 174 L77 195 L83 195 L83 174 M78 178 L82 178 M78 182 L82 182 M78 186 L82 186 M78 190 L82 190' /%3E%3C!-- Outlet --%3E%3Crect x='120' y='170' width='20' height='25' rx='2' fill='none' stroke='%230284c7' stroke-width='2'/%3E%3Cpath d='M126 177 L126 182 M134 177 L134 182 M128 187 C128 189 132 189 132 187' stroke='%230284c7' stroke-width='1.5' fill='none'/%3E%3C!-- Pipe Wrench --%3E%3Cpath d='M170 170 L175 175 L173 180 L178 185 L180 183 L175 178 L177 173 L172 168 L170 170 M178 185 L178 195 L180 195 L180 185' /%3E%3C/g%3E%3C/svg%3E");
  background-size: 200px 200px;
  background-repeat: repeat;
}

.dark .tool-pattern-bg::before {
  opacity: 0.03;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='200' height='200' viewBox='0 0 200 200'%3E%3Cg fill='%2338bdf8' fill-opacity='1'%3E%3C!-- Hammer --%3E%3Cpath d='M25 35 L25 20 L35 20 L35 25 L30 25 L30 35 L25 35 M27 35 L27 55 L28 55 L28 35' /%3E%3C!-- Screwdriver --%3E%3Cpath d='M75 18 L80 18 L80 22 L78.5 24 L78.5 50 L76.5 50 L76.5 24 L75 22 L75 18 M76.5 50 L76.5 55 L78.5 55 L78.5 50' /%3E%3C!-- Wrench --%3E%3Cpath d='M125 20 C120 20 118 25 120 28 L120 30 L122 30 L122 50 L128 50 L128 30 L130 30 L130 28 C132 25 130 20 125 20 M123 22 C124 21 126 21 127 22 C128 23 128 25 127 26 L123 26 C122 25 122 23 123 22' /%3E%3C!-- Drill --%3E%3Cpath d='M170 25 L185 25 L185 35 L180 35 L180 32 L175 32 L175 35 L170 35 L170 25 M165 28 L170 28 L170 32 L165 32 L165 28 M185 28 L195 29 L195 31 L185 32' /%3E%3C!-- Saw --%3E%3Cpath d='M20 85 L55 85 L55 90 L53 92 L51 90 L49 92 L47 90 L45 92 L43 90 L41 92 L39 90 L37 92 L35 90 L33 92 L31 90 L29 92 L27 90 L25 92 L23 90 L20 90 L20 85 M20 82 L25 82 L25 85 L20 85' /%3E%3C!-- Pliers --%3E%3Cpath d='M80 80 L85 85 L83 87 L80 84 L80 95 L78 95 L78 84 L75 87 L73 85 L78 80 L80 80 M78 95 L76 100 L74 100 L76 95 M80 95 L82 100 L84 100 L82 95' /%3E%3C!-- Tape Measure --%3E%3Ccircle cx='130' cy='90' r='12' fill='none' stroke='%2338bdf8' stroke-width='3'/%3E%3Cpath d='M130 90 L145 90 L145 88 L130 88' /%3E%3Ccircle cx='130' cy='90' r='4' /%3E%3C!-- Level --%3E%3Cpath d='M165 85 L195 85 L195 95 L165 95 L165 85 M175 87 L185 87 L185 93 L175 93 L175 87' fill='none' stroke='%2338bdf8' stroke-width='2'/%3E%3Ccircle cx='180' cy='90' r='2' /%3E%3C!-- Paint Roller --%3E%3Cpath d='M25 130 L25 140 L50 140 L50 130 L25 130' fill='none' stroke='%2338bdf8' stroke-width='2'/%3E%3Cpath d='M37 140 L37 155 L38 155 L38 140' /%3E%3Crect x='35' y='155' width='6' height='3' /%3E%3C!-- Lightbulb --%3E%3Cpath d='M80 125 C73 125 68 130 68 137 C68 142 72 145 75 148 L75 155 L85 155 L85 148 C88 145 92 142 92 137 C92 130 87 125 80 125' fill='none' stroke='%2338bdf8' stroke-width='2'/%3E%3Cpath d='M76 155 L76 158 L84 158 L84 155 M77 158 L77 160 L83 160 L83 158' /%3E%3C!-- House --%3E%3Cpath d='M130 155 L130 135 L120 145 L120 155 L130 155 M125 125 L110 140 L112 142 L125 130 L138 142 L140 140 L125 125 M130 135 L140 145 L140 155 L130 155' fill='none' stroke='%2338bdf8' stroke-width='2'/%3E%3Crect x='123' y='147' width='4' height='8' /%3E%3C!-- Gear/Cog --%3E%3Ccircle cx='180' cy='140' r='8' fill='none' stroke='%2338bdf8' stroke-width='2'/%3E%3Ccircle cx='180' cy='140' r='3' /%3E%3Cpath d='M180 130 L180 133 M180 147 L180 150 M170 140 L173 140 M187 140 190 140 M173 133 L175 135 M185 145 L187 147 M173 147 L175 145 M185 135 L187 133' stroke='%2338bdf8' stroke-width='2'/%3E%3C!-- Nail --%3E%3Cpath d='M35 175 L35 195 L37 195 L37 178 L40 175 L35 175' /%3E%3C!-- Screw --%3E%3Cpath d='M80 170 L80 172 L75 172 L75 174 L85 174 L85 172 L80 172 M77 174 L77 195 L83 195 L83 174 M78 178 L82 178 M78 182 L82 182 M78 186 L82 186 M78 190 L82 190' /%3E%3C!-- Outlet --%3E%3Crect x='120' y='170' width='20' height='25' rx='2' fill='none' stroke='%2338bdf8' stroke-width='2'/%3E%3Cpath d='M126 177 L126 182 M134 177 L134 182 M128 187 C128 189 132 189 132 187' stroke='%2338bdf8' stroke-width='1.5' fill='none'/%3E%3C!-- Pipe Wrench --%3E%3Cpath d='M170 170 L175 175 L173 180 L178 185 L180 183 L175 178 L177 173 L172 168 L170 170 M178 185 L178 195 L180 195 L180 185' /%3E%3C/g%3E%3C/svg%3E");
}

/* Custom scrollbar for sky theme */
::-webkit-scrollbar {
  width: 8px;
  height: 8px;
}

::-webkit-scrollbar-track {
  background: hsl(var(--muted));
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: hsl(var(--primary) / 0.3);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: hsl(var(--primary) / 0.5);
}

/* Smooth transitions for theme switching */
* {
  transition: background-color 0.2s ease, border-color 0.2s ease;
}

/* Prevent transitions on page load */
.preload * {
  transition: none !important;
}

/* Hide scrollbar for tab navigation */
.scrollbar-hide {
  -ms-overflow-style: none;
  scrollbar-width: none;
}

.scrollbar-hide::-webkit-scrollbar {
  display: none;
}

/* iPhone-style wiggle animation for edit mode - classic iOS home screen effect */
/* Two alternating keyframe sets with subtle rotation angles */
@keyframes ios-wiggle-1 {
  0% {
    transform: rotate(-0.5deg);
    animation-timing-function: ease-in;
  }
  50% {
    transform: rotate(0.75deg);
    animation-timing-function: ease-out;
  }
}

@keyframes ios-wiggle-2 {
  0% {
    transform: rotate(0.5deg);
    animation-timing-function: ease-in;
  }
  50% {
    transform: rotate(-0.75deg);
    animation-timing-function: ease-out;
  }
}

/* Basic wiggle for other elements (like tab navigation) */
.animate-wiggle {
  animation: ios-wiggle-1 0.3s ease-in-out infinite;
  transform-origin: 50% 30%;
}

/* Dashboard card wiggle - iOS style with contained rotation */
/* Even cards use wiggle-1, odd cards use wiggle-2 (set via nth-child or inline) */
.animate-wiggle-card-even {
  animation: ios-wiggle-1 infinite;
  animation-direction: normal;
  transform-origin: 50% 40%;
}

.animate-wiggle-card-odd {
  animation: ios-wiggle-2 infinite;
  animation-direction: alternate;
  transform-origin: 45% 35%;
}

/* Dashboard card being dragged */
.dashboard-card-dragging {
  position: fixed !important;
  z-index: 9999 !important;
  pointer-events: none !important;
  cursor: grabbing !important;
  box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25) !important;
  animation: none !important;
}

/* Dashboard card placeholder (ghost) */
.dashboard-card-placeholder {
  opacity: 0.3;
  pointer-events: none;
}

/* Drop target indicator */
.dashboard-card-drop-target {
  outline: 2px dashed hsl(var(--primary));
  outline-offset: 4px;
}

/* Hammer and nail loading animation */
/* Hammer: head on top, handle below, pivots from bottom (hand position at 65,75) */
/* Starts raised/cocked back (positive rotation), swings down-left (negative rotation) to strike */
@keyframes hammer-swing {
  0%, 100% {
    transform: rotate(30deg); /* Raised position - cocked back to the right */
  }
  10% {
    transform: rotate(35deg); /* Slight extra wind-up */
  }
  35% {
    transform: rotate(-20deg); /* Swinging down and to the left */
  }
  42%, 52% {
    transform: rotate(-35deg); /* Impact! Hammer head strikes nail */
  }
  60% {
    transform: rotate(-25deg); /* Slight recoil after impact */
  }
  75% {
    transform: rotate(10deg); /* Rising back up */
  }
}

@keyframes nail-drive {
  0%, 38% {
    transform: translateY(0); /* Nail at starting position */
  }
  42%, 100% {
    transform: translateY(4px); /* Nail driven down on impact */
  }
}

@keyframes impact-flash {
  0%, 38% {
    opacity: 0;
    transform: scale(0.2);
  }
  42% {
    opacity: 1;
    transform: scale(1);
  }
  55% {
    opacity: 0.7;
    transform: scale(1.4);
  }
  70%, 100% {
    opacity: 0;
    transform: scale(1.8);
  }
}

.animate-hammer-swing {
  animation: hammer-swing 1s ease-in-out infinite;
}

.animate-nail-drive {
  animation: nail-drive 1s ease-out infinite;
}

.animate-impact-flash {
  animation: impact-flash 1s ease-out infinite;
}

/* PWA-specific styles */

/* Offline indicator body class adjustment */
body.offline {
  padding-top: 36px;
}

/* Smooth slide-in animation for PWA banners */
@keyframes slide-in-from-bottom {
  from {
    opacity: 0;
    transform: translateY(100%);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.animate-in.slide-in-from-bottom-4 {
  animation: slide-in-from-bottom 0.3s ease-out;
}

/* Standalone mode adjustments (when running as installed PWA) */
@media all and (display-mode: standalone) {
  /* Add safe area padding for notched devices */
  body {
    padding-top: env(safe-area-inset-top);
    padding-bottom: env(safe-area-inset-bottom);
  }
  
  /* Adjust header for standalone mode */
  .sticky.top-0 {
    top: env(safe-area-inset-top);
  }
}

/* iOS-specific PWA adjustments */
@supports (-webkit-touch-callout: none) {
  /* Prevent bounce effect when scrolling at boundaries */
  html {
    height: 100%;
    overflow: hidden;
  }
  
  body {
    height: 100%;
    overflow: auto;
    -webkit-overflow-scrolling: touch;
  }
  
  /* Prevent text selection on long press for interactive elements */
  button, a, [role="button"] {
    -webkit-touch-callout: none;
  }
}
